---
description: Code style, TypeScript, and framework-specific patterns
globs:
  - "**/*.{ts,tsx,js,jsx}"
---

# Coding Patterns

> **Template**: Customize for your language/framework

---

## Language Configuration

### TypeScript Settings

```json
{
  "compilerOptions": {
    "strict": true,
    "noUncheckedIndexedAccess": true,
    "noImplicitReturns": true,
    "exactOptionalPropertyTypes": true
  }
}
```

### Key Rules

- Strict mode ON
- Explicit return types for public functions
- No `any` - use `unknown` when type is uncertain
- Prefer `interface` over `type` for object shapes

---

## Naming Conventions

### Files and Directories

| Type | Convention | Example |
|------|------------|---------|
| Components | PascalCase | `UserProfile.tsx` |
| Hooks | camelCase with `use` | `useAuth.ts` |
| Utils | camelCase | `formatDate.ts` |
| Types | PascalCase | `User.types.ts` |
| Constants | SCREAMING_SNAKE | `API_ENDPOINTS.ts` |
| Directories | kebab-case | `user-profile/` |

### Code

```typescript
// Variables - camelCase
const userName = 'John'

// Constants - SCREAMING_SNAKE_CASE
const API_BASE_URL = 'https://api.example.com'

// Functions - camelCase, verb prefix
function getUserById(id: string) {}
function handleSubmit() {}

// Types/Interfaces - PascalCase
interface UserProfile {}
type ButtonVariant = 'primary' | 'secondary'

// Components - PascalCase
function UserCard() {}

// Hooks - camelCase with use prefix
function useUserData() {}
```

---

## Component Patterns

### Functional Components Only

```typescript
// ✅ CORRECT - Functional component
interface ButtonProps {
  variant?: 'primary' | 'secondary'
  children: React.ReactNode
  onClick?: () => void
}

export function Button({ 
  variant = 'primary', 
  children, 
  onClick 
}: ButtonProps) {
  return (
    <button 
      className={`btn btn-${variant}`}
      onClick={onClick}
    >
      {children}
    </button>
  )
}

// ❌ WRONG - Class component (avoid)
class Button extends React.Component {}
```

### Component Structure

```typescript
export function FeatureComponent({ prop1, prop2 }: Props) {
  // 1. Hooks (always at the top)
  const [state, setState] = useState()
  const { data } = useQuery()
  
  // 2. Derived/computed values
  const computedValue = useMemo(() => {}, [])
  
  // 3. Event handlers
  const handleClick = useCallback(() => {}, [])
  
  // 4. Effects (if needed)
  useEffect(() => {}, [])
  
  // 5. Early returns
  if (!data) return <Loading />
  
  // 6. Render
  return <div>{/* JSX */}</div>
}
```

---

## Hook Patterns

### Custom Hook Structure

```typescript
export function useFeatureData(id: string) {
  // State
  const [state, setState] = useState()
  
  // Queries
  const query = useQuery({
    queryKey: ['feature', id],
    queryFn: () => fetchFeature(id),
  })
  
  // Mutations
  const mutation = useMutation({
    mutationFn: updateFeature,
    onSuccess: () => {
      // Invalidate queries
    },
  })
  
  // Return organized object
  return {
    // Data
    data: query.data,
    isLoading: query.isLoading,
    error: query.error,
    
    // Actions
    update: mutation.mutate,
    isUpdating: mutation.isPending,
  }
}
```

---

## Type Patterns

### Interface vs Type

```typescript
// Interface - for object shapes (preferred)
interface User {
  id: string
  name: string
  email: string
}

// Type - for unions, primitives, computed types
type Status = 'pending' | 'approved' | 'rejected'
type UserWithPosts = User & { posts: Post[] }
```

### Props Types

```typescript
// Props interface naming
interface ButtonProps {
  variant?: 'primary' | 'secondary'
  size?: 'sm' | 'md' | 'lg'
  children: React.ReactNode
  onClick?: () => void
}

// Extending native elements
interface InputProps extends React.InputHTMLAttributes<HTMLInputElement> {
  label: string
  error?: string
}
```

### Generic Types

```typescript
// API response wrapper
interface ApiResponse<T> {
  data: T
  meta: {
    total: number
    page: number
  }
}

// Usage
type UsersResponse = ApiResponse<User[]>
```

---

## Error Handling

### Try-Catch Pattern

```typescript
async function fetchData() {
  try {
    const response = await api.get('/data')
    return response.data
  } catch (error) {
    if (error instanceof ApiError) {
      // Handle specific error
      throw new Error(`API Error: ${error.message}`)
    }
    throw error
  }
}
```

### Error Boundaries

```typescript
// Wrap feature boundaries
<ErrorBoundary fallback={<ErrorFallback />}>
  <FeatureComponent />
</ErrorBoundary>
```

---

## Async Patterns

### Async/Await (Preferred)

```typescript
// ✅ CORRECT
async function fetchUser(id: string): Promise<User> {
  const response = await api.get(`/users/${id}`)
  return response.data
}

// ❌ AVOID - Promise chains (unless necessary)
function fetchUser(id: string): Promise<User> {
  return api.get(`/users/${id}`)
    .then(response => response.data)
}
```

---

## Import/Export Patterns

### Named Exports (Preferred)

```typescript
// ✅ CORRECT - Named exports
export function useAuth() {}
export const AuthContext = createContext()
export type { AuthState }

// ❌ AVOID - Default exports (except pages)
export default function useAuth() {}
```

### Re-exports

```typescript
// features/auth/index.ts
export { useAuth } from './hooks/useAuth'
export { AuthProvider } from './components/AuthProvider'
export type { User, AuthState } from './types'
```

---

## Code Quality

### Linting Rules

```javascript
// Key ESLint rules
{
  "rules": {
    "no-unused-vars": "error",
    "no-console": "warn",
    "prefer-const": "error",
    "@typescript-eslint/no-explicit-any": "error"
  }
}
```

### Formatting

```javascript
// Prettier config
{
  "semi": false,
  "singleQuote": true,
  "tabWidth": 2,
  "trailingComma": "es5"
}
```

---

## Anti-Patterns to Avoid

### Common Mistakes

```typescript
// ❌ Mutating state directly
state.items.push(newItem)

// ✅ Create new reference
setState(prev => [...prev.items, newItem])

// ❌ Conditional hooks
if (condition) {
  useEffect(() => {})
}

// ✅ Condition inside hook
useEffect(() => {
  if (condition) {
    // do something
  }
}, [condition])

// ❌ Inline objects in deps
useEffect(() => {}, [{ id }])

// ✅ Primitive deps
useEffect(() => {}, [id])
```

---

## Related Rules

- `project-architecture.mdc` - File structure
- `state-management.mdc` - Data patterns
- `testing-strategy.mdc` - Test patterns
